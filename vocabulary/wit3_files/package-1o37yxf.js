Module.define("vcom/units/assignments","params date jquery vcom/api datepicker timepicker".split(" "),function(){var v=jQuery,z={p:{code:"p",name:"Practice",article:""},s:{code:"s",name:"Spelling Bee",article:"a "},q:{code:"q",name:"Quiz",article:"a "},w:{code:"w",name:"Paper Quiz",article:"a "},j:{code:"j",name:"Vocabulary Jam",article:"a "}},D=0,F=v("link[rel\x3dcanonical]").attr("href");v=v('meta[name\x3d"vocab:unit:id"]').attr("content");var G=modules.vcom.api.remote("/units/"+v,{cache:"default"});
jQuery(function(g){function v(){p.find(".viewSelector *[data-mode\x3dexisting]").addClass("selected").siblings(".selected").removeClass("selected");p.attr("data-mode","existing").data("mode","existing")}function n(){p.find(".viewSelector *[data-mode\x3dnew]").addClass("selected").siblings(".selected").removeClass("selected");p.attr("data-mode","new").data("mode","new")}function x(a){if(null==e||a)e=G.then(function(a){var d=a.unit.items.filter(function(a){return"list"==a.type});return g.post("/lists/assignments.json",
{listids:d.map(function(a){return a.id})},function(b){b.lists=d;b.unit=a.unit})});return e}function C(a){a=A.find(".slide.selected").removeClass("selected").addClass("prev").nextAll(a||".slide.ondeck").first().addClass("selected").removeClass("ondeck");a.data("name")&&history.pushState(g.extend({},history.state,{name:a.data("name"),id:D++}),"",document.location);a.trigger("slide-show")}function c(){history.back()}function f(){var a=g('\x3cdiv class\x3d"slide assignmenttype selected" data-name\x3d"assignmenttype"\x3e\x3c/div\x3e').on("reset",
function(){a.find("form")[0].reset();delete modules.params.parse().type}).appendTo(A);h.validUser&&u().appendTo(a);g('\x3cform\x3e\x3cdiv class\x3d"field activities"\x3e\n\t\t\t\t\t\x3ch3\x3eWhat type of activity would you like to assign?\x3c/h3\x3e\n\t\t\t\t\t\x3cdiv class\x3d"value" \x3e\n\t\t\t\t\t\t\x3clabel class\x3d"practice"\x3e\x3cinput type\x3d"radio" name\x3d"type" value\x3d"p"\x3e\x3ci class\x3d"icon"\x3e\x3c/i\x3e\x3cspan class\x3d"title"\x3ePractice\x3c/span\x3e\n\t\t\t\t\t\t\x3cspan class\x3d"description "\x3eAn adaptive activity where students answer a few questions on each word in this list.\n\t\t\t\t\t\tIf a student struggles with a word, we follow-up with additional questions.\x3c/span\x3e\x3c/label\x3e\n\t\t\t\t\t\t\x3clabel class\x3d"onlinequiz"\x3e\x3cinput type\x3d"radio" name\x3d"type" value\x3d"q"\x3e\x3ci class\x3d"icon"\x3e\x3c/i\x3e\x3cspan class\x3d"title"\x3eQuiz\x3c/span\x3e\n\t\t\t\t\t\t\x3cspan class\x3d"description "\x3eQuiz your students on this list. Easily customize your quiz by choosing specific words, question-types, and meanings to include.\x3c/span\x3e\x3c/label\x3e\n\t\t\t\t\t\t\x3clabel class\x3d"spelling"\x3e\x3cinput type\x3d"radio" name\x3d"type" value\x3d"s"\x3e\x3ci class\x3d"icon"\x3e\x3c/i\x3e\x3cspan class\x3d"title"\x3eSpelling Bee\x3c/span\x3e\n\t\t\t\t\t\t\x3cspan class\x3d"description "\x3eStudents are required to spell every word on the list.  If they get a word wrong, we follow up until they learn the spelling.\x3c/span\x3e\x3c/label\x3e\n\t\t\t\t\t\t\x3clabel class\x3d"vocabjam"\x3e\x3cinput type\x3d"radio" name\x3d"type" value\x3d"j"\x3e\x3ci class\x3d"icon"\x3e\x3c/i\x3e\x3cspan class\x3d"title"\x3eVocabulary Jam\x3c/span\x3e\n\t\t\t\t\t\t\x3cspan class\x3d"description "\x3eStudents join teams and compete in real-time to see which team can answer the most questions correctly.\x3c/span\x3e\x3c/label\x3e\n\t\t\t\t\t\x3c/div\x3e\x3c/form\x3e\n\t\t\t\x3c/div\x3e').appendTo(a);
a.on("slide-show",function(){var d=modules.params.parse().type;d&&d.length&&a.find("input[type\x3dradio][value\x3d"+d+"]").prop("checked",!0).trigger("change")}).on("change",function(){var d=a.find("input[type\x3dradio]:checked").val();if(d){var b="q"==d||"w"==d;p.data("activity-type",d);p.find(".slide.create-account").length?C(".slide.create-account"):b&&!h.perms.createQuiz?C(".slide.quiz-options"):C()}else b=modules.params.parse(),delete b.type,history.replaceState(g.extend({},history.state,{type:d}),
"",b.toUrl())});return a}function r(){function a(a){if(a.is(".open"))a.find(".button.assign").text("Close");else if(a.is(".assigned")){var d=a.data("assignments");a.find(".button.assign").text("Edit "+d.assignments.length+"/"+d.classes.length)}else a.find(".button.assign").text("Assign")}var w=g('\x3cdiv class\x3d"slide ondeck" data-name\x3d"listselector"\x3e\x3c/div\x3e').appendTo(A);g("\x3ch3\x3eSelect the Lists you would like to assign \x3cspan\x3e\x3c/span\x3e to:\x3c/h3\x3e").appendTo(w);var l=
g('\x3cdiv class\x3d"items"\x3e\x3cul\x3e\x3c/ul\x3e\x3c/div\x3e').appendTo(w).find("ul");w.on("click","*[data-action\x3dopen]",function(){a(g(this).closest("li").toggleClass("open"));return!1});w.on("slide-show",function(){var d=z[p.data("activityType")];w.find("h3 span").text(d.article+d.name);var e=x();"j"==d.code?e.then(function(a){a=a.lists;l.empty().append(a.map(function(a){return g('\x3cli\x3e\x3cdiv class\x3d"row" \x3e\n\t\t\t\t\t\t\x3cdiv class\x3d"details"\x3e\x3cdiv class\x3d"header"\x3e\x3c/div\x3e\x3ca class\x3d"title" \x3e\x3c/a\x3e\x3c/div\x3e\n\t\t\t\t\t\t\x3cdiv class\x3d"actions"\x3e\x3ca role\x3d"button" class\x3d"button jam"\x3eStart\x3cspan class\x3d"hide-mobile"\x3e a Jam\x3c/span\x3e\x3c/a\x3e\x3c/div\x3e\n\t\t\t\t\t\t\x3c/div\x3e\x3c/li\x3e').attr("data-list-id",
a.id).find("a").attr("href","/lists/"+a.id+"/jam").end().find(".header").text(a.word_count+" Words ").end().find(".title").text(a.name||a.title).end()}))}):(e=x(),e.then(function(d){d=d.lists;l.empty().append(d.map(function(d){var l=g('\x3cli\x3e\x3cdiv class\x3d"row" data-action\x3d"open" \x3e\n\t\t\t\t\t\t\x3cdiv class\x3d"details"\x3e\x3cdiv class\x3d"header"\x3e\x3c/div\x3e\x3ca data-action\x3d"open" class\x3d"title" \x3e\x3c/a\x3e\x3c/div\x3e\n\t\t\t\t\t\t\x3cdiv class\x3d"actions"\x3e\x3cdiv class\x3d"button outline assign" role\x3d"button" data-action\x3d"open" \x3eAssign\x3c/div\x3e\x3c/div\x3e\n\t\t\t\t\t\t\x3c/div\x3e\x3c/li\x3e').attr("data-list-id",
d.id).find(".header").text(d.word_count+" Words ").end().find(".title").text(d.name||d.title).attr("href",d.html_url).end();d=E(d.id,e.then(b.bind(this,d.id)));g('\x3cdiv class\x3d"wrapper"\x3e\x3c/div\x3e').appendTo(l).append(d);l.on("data-loaded",function(){a(l)}).on("assignment-created",function(d){l.removeClass("open");a(l);var b=l.nextAll("li.available").first();if(b.length){var w=b.find(".assignment-options").data("assignmentOptions");w&&(d=d.assignment,w.options({classids:d.classids,startDate:m(d.startDate,
7),dueDate:m(d.dueDate,7)}));b.find(".button.assign").trigger("click");b.doTimeout("scroll",500,function(){b.scrollIntoView();b.find("button[type\x3dsubmit]").focus()})}});return l}));setTimeout(function(){var a=l.children("li:not(.assigned)").first();a.length||(a=l.children("li.available").first());a.find(".row .button.assign").trigger("click");a.scrollIntoView()},1E3)}))});g('\x3cdiv class\x3d"actions"\x3e\n\t\t\t\t\t\x3cbutton type\x3d"button" class\x3d"ss-navigateleft" data-action\x3d"prev"\x3ePrevious\x3c/button\x3e\n\t\t\t\t\x3c/div\x3e').appendTo(w);
return w}function E(d,w){function l(){H(d).then(A).then(function(a){h.trigger("data-loaded")})}function e(a,d){return g.post("/lists/removeassignment.json",{classids:d,assignmentid:a}).done(function(){h.trigger("assignment-deleted");l()}).fail(function(a){403===a.status&&(location.href="/account/classes")})}function A(a){var d=h.find(".existing-assignments ul.assignments").empty();a.assignments.length?(h.find(".existing-assignments").show(),d.append(a.assignments.map(q))):h.find(".existing-assignments").hide();
a.availableClasses.length?h.find("ul.classes.available").removeClass("noresults").empty().append(a.availableClasses.map(function(a){return g("\x3cli \x3e\x3clabel\x3e\x3c/label\x3e\x3c/li\x3e").data(a).find("label").append(g('\x3cinput type\x3d"checkbox" name\x3d"classids" /\x3e').val(a.id)).append('\x3ci class\x3d"icon ss-check checkbox" /\x3e').append(g('\x3cdiv class\x3d"name"/\x3e').text(a.n)).append(g('\x3cdiv class\x3d"dates"/\x3e').text(k(a.sdy).format("mmmm d")+" - "+k(a.edy).format("mmmm d"))).end()})):
a.assignments.length?h.find("ul.classes.available").addClass("noresults").empty().append('\x3cspan class\x3d"noresults"\x3eYou\'ve assigned this list to all your classes.'):h.find("ul.classes.available").addClass("noresults").empty().append('\x3cspan class\x3d"noresults"\x3e\n\t\t\t\t\t\t\t\tYou must create a create a class to assign this list.\n\t\t\t\t\t\t\t\t\x3cbr\x3e\x3ca class\x3d"button green" href\x3d"/account/classes/new" \x3eCreate a new class...\x3c/a\x3e\x3c/span\x3e');h.closest("li").data("assignments",
a).toggleClass("assigned",!!a.assignments.length).toggleClass("available",!!a.availableClasses.length);return a}function c(){var d=h.find(".dates.end input.date").val(),b=h.find(".dates.end input.time").val(),l=h.find(".dates.start input.date").val(),w=h.find(".dates.start input.time").val(),e=h[0];e.duedate.value=b.length&&d.length?(new Date(d+" "+b)).getTime():"";e.startdate.value=w.length&&l.length?(new Date(l+" "+w)).getTime():"";d=a(e);"string"===typeof d.classids&&(d.classids=[d.classids]);
return d}var h=g('\x3cform class\x3d"assignment-options"\x3e\n\t\t\t\x3cdiv class\x3d"grid grid-2 flex responsive"\x3e\n\t\t\t\t\x3cdiv class\x3d"col"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"available-classes"\x3e\n\t\t\t\t\t  \x3ch4\x3eSelect the classes to assign this to:\x3c/h4\x3e\n\t\t\t\t\t  \x3cul class\x3d"checklist classes available"\x3e\x3c/ul\x3e\n\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\x3cdiv class\x3d"existing-assignments"\x3e\n\t\t\t\t\t  \x3ch4\x3eExisting Assignments:\x3c/h4\x3e\n\t\t\t\t\t  \x3cul class\x3d"assignments"\x3e\x3c/ul\x3e\n\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3cdiv class\x3d"col"\x3e\n\t\t\t\x3ch4 \x3eAssignment Details:\x3c/h4\x3e\n\t\t\t\x3cdiv class\x3d"input-daterange field"\x3e\n\t\t\t\t\x3cdiv class\x3d"dates start field"\x3e\n\t\t\t\t\x3cinput type\x3d"hidden" name\x3d"startdate" value\x3d""/\x3e\n\t\t\t\t\x3cdiv class\x3d"value"\x3e\x3cspan class\x3d"label"\x3eVisible \x3cspan class\x3d"hide-mobile"\x3estarting\x3c/span\x3e: \x3c/span\x3e\x3cinput class\x3d"date" type\x3d"text" required\x3d"required" data-date-format\x3d"mm/dd/yyyy" value\x3d"" /\x3e\n\t\t\t\t \x3cspan\x3e at \x3c/span\x3e\x3cinput class\x3d"time" type\x3d"text" required\x3d"required" data-default-time\x3d"7:00 AM" value\x3d"7:00 AM" /\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\t\n\t\t\t\t\x3cdiv class\x3d"dates end field"\x3e\n\t\t\t\t\x3cinput type\x3d"hidden" name\x3d"duedate" value\x3d""/\x3e\n\t\t\t\t\x3cdiv class\x3d"value"\x3e\x3cspan class\x3d"label"\x3eDue by: \x3c/span\x3e\x3cinput class\x3d"date" type\x3d"text" required\x3d"required" data-date-format\x3d"mm/dd/yyyy"  value\x3d"" /\x3e\n\t\t\t\t \x3cspan\x3e at \x3c/span\x3e\x3cinput class\x3d"time" type\x3d"text" required\x3d"required" data-default-time\x3d"10:00 PM" value\x3d"10:00 PM" /\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\t\n\t\t\t\t\x3cdiv class\x3d"notes"\x3eDue dates are for informational purposes only.  You can decide what to do if a student completes this assignment late.\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"field notes"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"value"\x3e\x3cspan class\x3d"label"\x3eNotes:\x3c/span\x3e\x3ctextarea name\x3d"notes" placeholder\x3d"directions to students (optional)"\x3e\x3c/textarea\x3e\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cinput type\x3d"hidden" name\x3d"type" \x3e\x3cinput type\x3d"hidden" name\x3d"listid" \x3e\n\t\t\t\x3cdiv class\x3d"actions"\x3e\x3cbutton class\x3d"green" disabled\x3d"disabled" type\x3d"submit" \x3eSave Assignment\x3c/button\x3e\x3c/div\x3e\n\t\t\t\x3c/form\x3e'),
u=new Date,f=p.data("activityType");h.find(".dates.start input.date").val(u.format("mm/dd/yyyy"));h.find(".dates.end input.date").val(m(u,6).format("mm/dd/yyyy"));h.find("input[name\x3dtype]").val(f);h.find("input[name\x3dlistid]").val(d);"q"==f?h.find("button[type\x3dsubmit]").text("Create Quiz"):"j"==f&&h.find("button[type\x3dsubmit]").text("Create Jam");h.data("assignmentOptions",{options:function(a){if(arguments.length)a.startDate&&(h.find(".dates.start input.date").datepicker("setDate",a.startDate),
h.find(".dates.start input.time").timepicker("setTime",a.startDate)),a.dueDate&&(h.find(".dates.end input.date").datepicker("setDate",a.dueDate),h.find(".dates.end input.time").timepicker("setTime",a.dueDate)),a.classids&&(h.find("input[name\x3dclassids]").prop("checked",!1),a.classids.length&&a.classids.forEach(function(a){h.find("input[name\x3dclassids][value\x3d"+a+"]").prop("checked",!0)})),h.trigger("change");else return a=c(),{classids:a.classids,startDate:new Date(a.startdate),dueDate:new Date(a.duedate)}}});
h.find(".input-daterange").datepicker({inputs:h.find(".input-daterange .date")});h.find(".input-daterange .time").timepicker({showInputs:!1,disableFocus:!0});h.on("click","ul.assignments *[data-action\x3ddelete]",function(){if(confirm("Are your sure you want to delete this assignment?")){var a=g(this).closest("li");e(a.data("id"),a.data("classid")).then(function(){a.slideUp(function(){a.remove()})})}});w.then(A).then(function(a){h.trigger("data-loaded")});h.on("change",function(a){a=c();h.find("button[type\x3dsubmit]").prop("disabled",
!(a.classids&&a.classids.length))}).on("submit",function(){var a=c();if(a.classids&&a.classids.length){if("q"==a.type||"w"==a.type)return g('\x3cinput type\x3d"hidden" name\x3d"name"\x3e').val(h.closest("li").find(".title").text()).appendTo(h),g('\x3cinput type\x3d"hidden" name\x3d"referer"\x3e').val(document.location).appendTo(h),this.method="get",this.action="/quiz/new",!0;if("j"==a.type)return this.method="get",this.action="/jam/new",!0;h.find("button[type\x3dsubmit]").prop("disabled",!0);g.post("/lists/"+
d+"/assign.json",a).done(function(l){l=b(d,l);A(l);h.trigger("change").trigger({type:"assignment-created",assignments:l,assignment:{classids:a.classids,startDate:new Date(a.startdate),dueDate:new Date(a.duedate)}})}).fail(function(a){403===a.status&&(location.href="/account/classes")})}return!1});return h}function y(a,b){return a==b?0:a<b?-1:1}function B(){function a(a){return x(a).then(function(a){a=g.extend({},a);a.byId={};var d=a.lists.reduce(function(a,d){a[d.id]=d;return a},{});a.classes.forEach(function(d){a.byId[d.id]=
d});a.assignments.forEach(function(b){b.cl=a.byId[b.classid];b.name=b.qn||(d[b.wlid]||{}).name});c=a.assignments;c.length?p.find(".viewSelector .count").text("("+c.length+")"):(p.find(".viewSelector .count").text(""),m.empty().append('\x3cdiv class\x3d"noresults"\x3eYou have not assigned this yet.\x3c/div\x3e'))})}function b(){l.attr("data-sort",h);m.empty();if(c.length){var a=e[h].value;c.sort(function(d,b){var l=y(a(d),a(b));0==l&&(l=y(e.className.value(d),e.className.value(b)));0==l&&(l=y(d.due,
b.due));0==l&&(l=y(e.type.value(d),e.type.value(b)));return l});var d=null,b=e[h].value;c.forEach(function(a){var l=b(a);l!=d&&null!=l&&g("\x3ch4\x3e\x3c/h4\x3e").text(l).appendTo(m);q(a).appendTo(m);d=l})}else m.append('\x3cdiv class\x3d"noresults"\x3eYou have not assigned this yet.\x3c/div\x3e')}var l=g('\x3cdiv class\x3d"pane existing-assignments clearfloat"\x3e\x3c/div\x3e');u().appendTo(l).find(".existing").addClass("selected").siblings(".selected").removeClass("selected");var e={className:{name:"Class",
value:function(a){return a.cl.n}},list:{name:"List",value:function(a){return a.qn||a.name}},type:{name:"Activity Type",value:function(a){return z[a.typ].name}}},h="className",A=g('\x3cdiv class\x3d"actions"\x3e\x3cspan class\x3d"label"\x3eSort By: \x3c/span\x3e\x3c/div\x3e').appendTo(l);g("\x3cselect\x3e\x3c/select\x3e").append(Object.keys(e).map(function(a){return g("\x3coption/\x3e").text(e[a].name).attr("value",a).prop("selected",a==h)})).on("change",function(){h=this.value;b()}).appendTo(A);var c=
[],m=g('\x3cul class\x3d"assignments"\x3e\x3c/ul\x3e').appendTo(l);m.on("click","*[data-action\x3ddelete]",function(){var d=g(this).closest("li"),b=d.data();confirm("Are your sure you want to delete this assignment?")&&g.post("/lists/removeassignment.json",{classids:[b.cl.id],assignmentid:b.id}).done(function(){d.slideUp(function(){d.remove()});d.prev().is("li")||d.next().is("li")||d.prev().slideUp();a(!0)}).fail(function(a){403===a.status&&(location.href="/account/classes")})});l.on("reload",function(){a().then(b)}).trigger("reload");
l.on("click","ul.assignments li .ss-write",function(){var d=g(this).closest("li").toggleClass("editing"),l=d.data(),e=g('\x3cform class\x3d"grid pullpadding2x"\x3e\n\t\t\t\t\x3cdiv class\x3d"col6 pad2x"\x3e\x3cdiv class\x3d"input-daterange field"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"dates start field"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"value"\x3e\x3cspan class\x3d"label"\x3eVisible starting: \x3c/span\x3e\x3cinput class\x3d"date" type\x3d"text" required\x3d"required"  data-date-format\x3d"mm/dd/yyyy" value\x3d"" /\x3e\n\t\t\t\t\t\x3cspan\x3e at \x3c/span\x3e\x3cinput class\x3d"time" type\x3d"text" required\x3d"required" data-default-time\x3d"7:00 AM" value\x3d"7:00 AM" /\x3e\n\t\t\t\t\t\x3c/div\x3e\x3c/div\x3e\n\t\t\t\t\t\x3cdiv class\x3d"dates end field"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"value"\x3e\x3cspan class\x3d"label"\x3eDue by: \x3c/span\x3e\x3cinput class\x3d"date" type\x3d"text" required\x3d"required" data-date-format\x3d"mm/dd/yyyy" value\x3d"" /\x3e\n\t\t\t\t\t\x3cspan\x3e at \x3c/span\x3e\x3cinput class\x3d"time" type\x3d"text" required\x3d"required" data-default-time\x3d"11:59 PM" value\x3d"11:59 PM" /\x3e\n\t\t\t\t\t\x3c/div\x3e\x3c/div\x3e\n\t\t\t\t\t\x3cdiv class\x3d"notes"\x3eDue dates are for informational purposes only. You can decide what to do if a student completes this assignment late. \x3c/div\x3e\n\t\t\t\t\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"col6 pad2x"\x3e\n\t\t\t\t\x3cdiv class\x3d"field notes"\x3e\n\t\t\t\t\x3cdiv class\x3d"label"\x3eNotes for students:\x3c/div\x3e\n\t\t\t\t\x3ctextarea name\x3d"notes" placeholder\x3d"directions to students (optional)"\x3e\x3c/textarea\x3e\n\t\t\t\t\x3c/div\x3e\x3c/div\x3e\x3c/form\x3e').on("submit",
function(w){d.removeClass("editing");w=e.find(".dates.end input.date").val();var h=e.find(".dates.end input.time").val(),p=e.find(".dates.start input.date").val(),k=e.find(".dates.start input.time").val();g.post("/lists/"+l.wlid+"/editassignment.json",{classid:l.classid,assignmentid:l.id,duedate:(new Date(w+" "+h)).getTime(),startdate:(new Date(p+" "+k)).getTime(),notes:d.find(".notes textarea").val()}).done(function(){a(!0).then(b)}).fail(function(){location.href="/account/classes"});return!1}).on("reset",
function(){d.removeClass("editing");e.remove()}).appendTo(d);e.find(".dates.start .time").val((new Date(l.vis)).format("hh:MM TT"));e.find(".dates.start .date").val((new Date(l.vis)).format("mm/dd/yyyy"));e.find(".dates.end .time").val((new Date(l.due)).format("hh:MM TT"));e.find(".dates.end .date").val((new Date(l.due)).format("mm/dd/yyyy"));e.find("textarea").val(l.notes);e.find(".input-daterange").datepicker({inputs:e.find(".date"),startDate:k(l.cl.sdy),endDate:k(l.cl.edy)});e.find(".input-daterange .time").timepicker({showInputs:!1,
disableFocus:!0});g('\x3cdiv class\x3d"col12 pad2x actions"\x3e\x3c/div\x3e').append(g('\x3cbutton type\x3d"submit" class\x3d"green" \x3eSave\x3c/button\x3e')).append(g('\x3cbutton type\x3d"reset" \x3eCancel\x3c/button\x3e')).appendTo(e)});return l}function H(a){return g.post("/lists/"+a+"/assignments.json").then(b.bind(this,a))}function q(a){var d=a.cl;return g('\x3cli\x3e\n\t\t\t\t\t\x3ca class\x3d"class"\x3e\x3cspan class\x3d"name"/\x3e\x3cspan class\x3d"dates"/\x3e\x3c/a\x3e\n\t\t\t\t\t\x3cdiv class\x3d"desc"\x3e\x3cspan class\x3d"type"/\x3e\x3cspan class\x3d"name"/\x3e\n\t\t\t\t\t\x3cdiv class\x3d"dates"\x3e\x3cspan class\x3d"startdate"/\x3e\x3cspan class\x3d"duedate"/\x3e\x3c/div\x3e\x3c/div\x3e\n\t\t\t\t\t\x3cdiv class\x3d"actions"\x3e\x3ca class\x3d"icon ss-view" role\x3d"button" title\x3d"Preview Assignment" /\x3e\x3ca class\x3d"icon ss-barchart" role\x3d"button" title\x3d"View Student progress" /\x3e\x3ci class\x3d"icon ss-write" role\x3d"button" title\x3d"Edit this assignment" /\x3e\x3ci class\x3d"icon ss-delete" data-action\x3d"delete" role\x3d"button" title\x3d"Delete this assignment" /\x3e\x3c/div\x3e\n\t\t\t\t\t\x3c/li\x3e').data(a).addClass("type-"+
a.typ).find(".desc .type").text(z[a.typ].name).end().find(".desc .name").text(a.name||"").end().find(".desc .startdate").text("visible on "+(new Date(a.vis)).format("mmmm dS, h:MM tt")).end().find(".desc .duedate").text("due on "+(new Date(a.due)).format("mmmm dS, h:MM tt")).end().find("a.class").attr("href","/classes/"+d.id+"/").end().find("a.ss-view").attr("href",a.url).end().find("a.ss-barchart").attr("href","/account/classes/"+d.id+"?view\x3dassignments\x26assignment\x3d"+a.id).end().find("a.class .name").text(d.n).end().find("a.class .dates").text(k(d.sdy).format("mmmm d")+
" - "+k(d.edy).format("mmmm d")).end()}function b(a,b){b=g.extend({},b);b.byId={};b.classes.sort(function(a,d){return a.n<d.n?-1:a.n>d.n?1:0});b.classes.forEach(function(a){a.types={q:0,p:0,s:0,w:0};b.byId[a.id]=a});var d=p.data("activityType")||"p";b.assignments=(b.assignments||[]).filter(function(b){return b.wlid==a&&b.typ==d});b.assignments.forEach(function(a){var d=b.byId[a.classid];d.types[a.typ]++;a.cl=d});b.availableClasses=b.classes.filter(function(a){return 0==a.types[d]});return b}function k(a){return new Date(parseInt(a/
1E4),parseInt(a/100)%100-1,a%100)}function m(a,b){a=new Date(a.getTime());a.setDate(a.getDate()+b);return a}function u(){return g('\x3cnav class\x3d"viewSelector noselect" style\x3d"margin-top: 2em;"\x3e\x3cul\x3e\n\t\t\t\x3cli data-mode\x3d"new" class\x3d"selected"\x3e\x3ca href\x3d"assign"\x3eNew Assignment\x3c/a\x3e\x3c/li\x3e\n\t\t\t\x3cli data-mode\x3d"existing"\x3e\x3ca href\x3d"assignments"\x3eCurrent Assignments  \x3cspan class\x3d"count"\x3e\x3c/span\x3e\x3c/a\x3e\x3c/li\x3e\n\t\t\t\x3c/ul\x3e\x3c/nav\x3e').find("a").on("click",
function(){var a=g(this).closest("li").data("mode");p.data("mode")!=a&&("existing"==a?(v(),history.pushState({id:D++},"",F+"/assignments")):"new"!=a||p.hasClass("mode-new")||(n(),history.pushState({id:D++},"",F+"/assign")));return!1}).end()}function a(a){return g(a).serializeArray().reduce(function(a,d){var b=d.name,l=a[b];d=d.value;null!=d&&0<d.length&&+d===+d&&(d=+d);null==l?a[b]=d:"function"==typeof l.push?l.push(d):a[b]=[l,d];return a},{})}var e=null,p=g(".assignment-picker").attr("data-mode",
"new"),A=g('\x3cdiv class\x3d"pane new-assignment slidedeck clearfloat selected"\x3e\x3c/div\x3e').appendTo(p),J,h=null;VCOM.auth(function(a){h=a;h.validUser?(J=B().appendTo(p),f().appendTo(A),r().appendTo(A),h.perms.createQuiz||g('\x3cdiv class\x3d"slide quiz-options unpaid ondeck" data-name\x3d"quiz-options"\x3e\n\t\t\t\x3cdiv class\x3d"limited-width"\x3e\n\t\t\t\t\t\n\t\t\t\x3cdiv class\x3d"actions"\x3e\t\n\t\t\t\t\t\x3ch3 style\x3d"margin-bottom:0;"\x3eAssess with less stress.\x3c/h3\x3e\t\n\t\t\t\t\t\x3ch3 style\x3d"margin-top:0; font-size: 1.3em;"\x3ePurchase a premium subscription to create custom quizzes.\x3c/h3\x3e\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\x3cdiv class\x3d"grid responsive"\x3e\n\t\t\t\t\x3cdiv class\x3d"col5 center pad2y"\x3e\n\t\t\t\t\x3ca class\x3d"button green" href\x3d"/membership/teachers/"\x3eGet Started Now\x3c/a\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\t\n\t\t\t\t\x3cdiv class\x3d"grid responsive"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"col7"\x3e\n\t\t\t\t\t\t\x3ch3 style\x3d"margin-bottom: 0;"\x3eGet the lowdown on your students\' improvement.\x3c/h3\x3e\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\x3cp\x3e\n\t\t\t\t\t\tCreate custom quizzes for both pre- and post- assessment.  \n\t\t\t\t\t\t\x3c/p\x3e\x3cp\x3e\n\t\t\t\t\t\tStart from any vocabulary list — we\'ll suggest words and\n\t\t\t\t\t\tquestions for your quiz based on the past performance of your students.\n\t\t\t\t\t\t\x3c/p\x3e\x3cp\x3e\n\t\t\t\t\t\tEasily customize which words and meanings to\n\t\t\t\t\t\ttest — choose any question from our ever-expanding library of over 180,000 questions.\n\t\t\t\t\t\t\n\t\t\t\t\t\t \n\t\t\t\t\t\t\x3c/p\x3e\n\t\t\t\t\t\t\x3cdiv class\x3d"actions center pad2y"\x3e\n\t\t\t\t\t\t\x3cbutton type\x3d"button" style\x3d"font-size: 1em;" class\x3d"ss-navigateleft" data-action\x3d"prev"\x3eGo back\x3c/button\x3e\x3ca class\x3d"button blue" style\x3d"font-size: 1em;" href\x3d"/membership/"\x3eLearn about our premium subscription\x3c/a\x3e\n\t\t\t\t\t\t\x3c/div\x3e\t\n\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\x3cdiv class\x3d"col4 margin1"\x3e\x3cimg src\x3d"/images/home/quiz-tools-array.png" style\x3d"transform: translateY(10%)" class\x3d"screenshots"\x3e\x3c/div\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e').appendTo(A)):
(f().appendTo(A),g('\x3cdiv class\x3d"slide create-account ondeck" data-name\x3d"create-account"\x3e\n\t\t\t\x3cdiv class\x3d"limited-width"\x3e\n\t\t\t\x3ch1\x3eAssign this collection to your students.\x3c/h1\x3e\n\t\t\t\x3ch3\x3eGet started by creating a free account.\x3c/h3\x3e\n\t\t\t\x3cdiv class\x3d"grid responsive"\x3e\n\t\t\t\x3cdiv class\x3d"col5 center pad2y"\x3e\n\t\t\t\x3ca class\x3d"button green" href\x3d"/signup/teacher/"\x3eSign up for a 30-day free teacher trial\x3c/a\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"grid responsive"\x3e\n\t\t\t\x3cdiv class\x3d"col7"\x3e\n\t\t\t\t\x3ch3 style\x3d"margin-bottom: 0;"\x3eSee your students learning.\x3c/h3\x3e\n\t\t\t\t\x3cp\x3eWith our \x3ca href\x3d"/membership/teachers/"\x3epremium subscription,\x3c/a\x3e you can assign activities, \n\t\t\t\tmonitor student progress, and see who\'s done their work. \n\t\t\t\tEasily identify the students at risk and see the words they\'re struggling with.\x3c/p\x3e\n\t\t\t\t\x3cdiv class\x3d"actions center pad2y"\x3e\n\t\t\t\t\t\x3cbutton type\x3d"button" style\x3d"font-size: 1em;" class\x3d"ss-navigateleft" data-action\x3d"prev"\x3eGo back\x3c/button\x3e\x3ca class\x3d"button blue" style\x3d"font-size: 1em;" href\x3d"/membership/"\x3eLearn about our premium subscription\x3c/a\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"col4 margin1"\x3e\n\t\t\t\x3cimg src\x3d"/images/home/teacher-tools-array.png" class\x3d"screenshots"\x3e\n\t\t\t\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e').appendTo(A));
document.location.pathname.endsWith("/assignments")&&v();A.find(".slide.selected").trigger("slide-show")});A.on("assignment-deleted assignment-created assignment-changed",function(){e=null;J.trigger("reload")});p.on("click","button[data-action\x3dcancel]",c);p.on("click","button[data-action\x3dnext]",C);p.on("click","button[data-action\x3dprev]",c);window.addEventListener("popstate",function(a){if(a.state&&a.state.name){var d=A.find(".slide.selected"),b=A.find(".slide[data-name\x3d"+a.state.name+
"]");d.length&&b.length&&(b.index(),d.index(),b.addClass("selected").removeClass("ondeck prev"),b.prevAll(".slide").addClass("prev").removeClass("ondeck selected"),b.nextAll(".slide").addClass("ondeck").removeClass("prev selected"))}else x(!0),p.find(".slide").trigger("reset").addClass("ondeck").removeClass("selected prev").first().addClass("selected").removeClass("ondeck").trigger("slide-show").end();document.location.pathname.endsWith("/assignments")?v():document.location.pathname.endsWith("/assign")&&
n();D=a.state?a.state.id||0:0})})});
Module.define("vcom/units/editor","jquery dotimeout vcom/api cropper pickr/pickr vcom/units/searcher datepicker date".split(" "),function(){function v(a){function b(b){var e={};e.related=a.related_units||[];b._context=e;e.subjects=p(b,["subject"],a);switch(b.type){case "subject":e.path=k(b,["subject"],a);break;case "publisher":e.path=k(b,["publisher"],a);break;case "collection":case "unit":case "work":e.path=k(b,["unit","collection","publisher"],a);e.authors=p(b,["author"],a);e.collections=p(b,["collection"],
a);e.publisher=k(b,["publisher"],a);break;case "author":e.collections=p(b,["collection"],a),e.publisher=k(b,["publisher"],a)}return b}function p(b,e){var d={},p=[];e=e.reduce(function(a,b){a[b]=!0;return a},{});a.related_units&&a.related_units.forEach(function(a){e[a.type]&&(d[a.id]=a)});b.parent_units&&b.parent_units.length&&b.parent_units.forEach(function(a){d[a]&&p.push(d[a])});return p}function k(b,e){var d={},p={},l=[];e=e.reduce(function(a,b){a[b]=!0;return a},{});a.related_units&&a.related_units.forEach(function(a){e[a.type]&&
(d[a.id]=a)});(function K(a){a&&(p[a.id]=!0,a.parent_units&&a.parent_units.forEach(function(a){!p[a]&&d[a]&&(l.push(d[a]),K(d[a]))}))})(b);l.reverse();return l}a.unit&&b(a.unit);a.related_units&&a.related_units.forEach(b);a.units&&a.units.forEach(b);console.log(a);return a}function z(){return D({unit:{}})}function D(a){function e(){B.empty();var a=m[d.type]||m.unit;a.assets&&B.append(a.assets.map(function(a){return G(d,a)}))}function p(){d.items&&H.find("ul.item-list").empty().append(d.items.map(function(a,
e){return b("\x3cli\x3e\x3c/li\x3e").addClass(a.type).append(b('\x3cspan class\x3d"item-type"\x3e\x3c/span\x3e').text(g(a))).append(b('\x3cspan class\x3d"title"\x3e\x3c/span\x3e').text(a.title)).append(r({field:"name",label:"Short Name",required:!1},a)).append(E({field:"description",label:"Description",maxlength:1E3},a)).append('\x3cdiv class\x3d"actions"\x3e\x3cbutton class\x3d"ss-up"\x3e\x3c/button\x3e\x3cbutton class\x3d"ss-down"\x3e\x3c/button\x3e\x3cbutton class\x3d"ss-delete"\x3e\x3c/button\x3e\x3c/div\x3e').on("click",
".ss-delete",function(){b(this).closest("li").remove();d.items.splice(d.items.indexOf(a),1)}).on("click",".ss-up",function(){var e=d.items.indexOf(a);if(0<e){var l=d.items[e-1];d.items[e-1]=d.items[e];d.items[e]=l;e=b(this).closest("li");e.insertBefore(e.prev("li"))}}).on("click",".ss-down",function(){var e=d.items.indexOf(a);if(0<=e&&e<d.items.length-1){var l=d.items[e+1];d.items[e+1]=d.items[e];d.items[e]=l;e=b(this).closest("li");e.insertAfter(e.next("li"))}})}))}function k(a){d.items||(d.items=
[]);a&&a.name?d.items.push({id:a.id,type:"list",title:a.name}):a&&a.title&&a.type&&d.items.push({id:a.id,type:a.type,title:a.title});p();v.data("refilter")()}function u(){return b.when.apply(b,B.find(".asset").map(function(){return b(this).data("asset").commit()}).get())}var h=new b.Deferred,d=a.unit,w=b('\x3cdiv class\x3d"dialog unit-editor"\x3e\n\t\t\t\t\x3cdiv class\x3d"blocker"\x3e\x3c/div\x3e\n\t\t\t\t\x3cdiv class\x3d"content"\x3e\n\t\t\t\t\x3cheader\x3e\x3ch3\x3e\x3cspan class\x3d"unit-action"\x3eEdit\x3c/span\x3e \x3cspan class\x3d"unit-type-name"\x3eUnit\x3c/span\x3e\x3c/h3\x3e\x3c/header\x3e\n\t\t\t\t\x3cform action\x3d"javascript:void(0)"\x3e\n\t\t\t\t\t\n\t\t\t\t\x3c/form\x3e\n\t\t\t\t\x3cfooter\x3e\x3cdiv class\x3d"actions"\x3e\n\t\t\t\t\x3cbutton data-action\x3d"delete" class\x3d"red"\x3eDelete\x3c/button\x3e\x3cbutton data-action\x3d"cancel"\x3eCancel\x3c/button\x3e\x3cbutton data-action\x3d"save" class\x3d"green save"\x3eSave\x3c/button\x3e\n\t\t\t\t\x3c/div\x3e\x3c/footer\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\x3c/div\x3e').appendTo("body"),
l=w.find("form");l.append(r({field:"title",label:"Title / Name",required:!0},d)).append(r({field:"subtitle",label:"Subtitle"},d)).append(r({field:"source_url",label:"Source URL"},d)).append(x(r({field:"isbn",label:"ISBN"},d),r({field:"asin",label:"ASIN"},d))).append(x(f({field:"featured_at",label:"Feature On"},d),f({field:"featured_end_at",label:"End Feature On"},d),c({field:"promoted",label:"Promoted"},d),c({field:"hidden",label:"Hidden"},d))).append(r({field:"publish_year",label:"Year Published",
type:"int",pattern:"[0-9]{4}",maxlength:4,length:4},d)).append(E({field:"short_description",label:"Description",maxlength:1E3},d)).append(E({field:"description",label:"Long Description",maxlength:5E3},d)).append(r({field:"keywords",label:"Keywords",maxlength:1E3},d)).append(I(d));d.id?(w.find(".unit-type-name").text(g(d)),l.attr("data-type",d.type)):(d.type="unit",w.find(".unit-action").text("New"),w.addClass("new"));l.prepend(C({field:"type",label:"Unit Type",options:[{text:"Unit",value:"unit"},
{text:"Author",value:"author"},{text:"Work",value:"work"},{text:"Subject",value:"subject"},{text:"Publisher",value:"publisher"},{text:"Collection",value:"collection"}]},d));l.find('*[data-field-name\x3d"type"] select').on("blur",function(){l.attr("data-type",d.type);e()});var y=b('\x3cdiv class\x3d"field"\x3e\x3clabel\x3eParent\x3c/label\x3e\x3cul class\x3d"tageditor"\x3e\x3c/ul\x3e\x3c/div\x3e'),q=y.find(".tageditor");F(q,{unit:d,tags:a.related_units,single:!0,types:["collection","unit","publisher"]});
q=b('\x3cdiv class\x3d"field"\x3e\x3clabel\x3eTags\x3c/label\x3e\x3cul class\x3d"tageditor"\x3e\x3c/ul\x3e\x3c/div\x3e');var n=q.find(".tageditor");F(n,{unit:d,tags:a.related_units,types:["subject","author"]});x(y,q).appendTo(l);r({field:"num_displayed_authors",label:"Number of Authors to Display",type:"int"},d).appendTo(l);var B=b('\x3cdiv class\x3d"assets"\x3e\x3c/div\x3e').appendTo(l);e();var H=b('\x3csection class\x3d"items"\x3e\x3ch4\x3eLists \x26 Sub-Units\x3c/h4\x3e\n\t\t\t\t\x3cdiv class\x3d"add-row"\x3e\x3clabel\x3eAdd:\x3c/label\x3e\x3cdiv class\x3d"searcher"\x3e\x3c/div\x3e\x3c/div\x3e\n\t\t\t\t\x3cul class\x3d"item-list"\x3e\x3c/ul\x3e\x3c/section\x3e').appendTo(l),
v=modules.vcom.units.searcher.Searcher({unit:d});H.find(".searcher").append(v).end().find(".add-row").on("select",function(a){k(a.list||a.unit)}).append('\x3cbutton data-action\x3d"new-unit"\x3eNew Unit\x3c/button\x3e');p();w.on("click",'*[data-action\x3d"new-unit"]',function(){z().then(function(a){VCOM.recentUnits(a.id);k(a)})});w.on("click",'*[data-action\x3d"delete"]',function(){confirm("Are you sure you want to delete this unit?")&&modules.vcom.api.remote("/units/"+d.id,{method:"DELETE"}).then(function(a){h.resolveWith(a,
!0)}).fail(function(a){h.reject(a)})});w.on("click",'*[data-action\x3d"cancel"]',function(){h.reject()}).on("click",'*[data-action\x3d"save"]',function(){var a=b.extend({},d);delete a._context;d.id?modules.vcom.api.remote("/units/"+d.id,{method:"PUT",data:{unit:a}}).then(function(a){u().then(function(){h.resolveWith(a,[a.unit])}).fail(function(a){h.reject(a)})}).fail(function(a){h.reject(a)}):modules.vcom.api.remote("/units/",{method:"POST",type:"json",data:{unit:a}}).then(function(a){d.id=a.unit.id;
u().then(function(){h.resolveWith(a,[a.unit])}).fail(function(a){h.reject(a)})}).fail(function(a){h.reject(a)})});h.always(function(){w.remove()});return h}function F(a,e){function p(a){return b('\x3cli class\x3d"tag"\x3e\x3cspan class\x3d"item-type"\x3e\x3c/span\x3e\x3cspan class\x3d"label"\x3e\x3c/span\x3e\x3cdiv role\x3d"button" class\x3d"delete ss-delete"\x3e\x3c/div\x3e\x3c/li\x3e').find(".item-type").text(g(a)).end().find(".label").text(a.full_title).end().addClass(a.type).data(a)}function k(){function k(){u.show();
var b=a.offset();b.top+=a.outerHeight();u.offset(b);return u}function l(a){var b=a.data("id");a=p(a.data());e.unit.parent_units||(e.unit.parent_units=[]);e.unit.parent_units.push(b);a.insertBefore(y.closest("li"));y.val("").focus()}function m(){console.log("stopped editing");y.closest("li").remove();u.remove();h=!1}h=!0;var A=a.closest("form"),u=b('\x3cul class\x3d"unit-editor-tag-autocomplete results units"\x3e\x3c/ul\x3e').appendTo(A).hide(),f="",y=b('\x3cli class\x3d"input"\x3e\x3cinput type\x3d"text"\x3e\x3c/input\x3e\x3c/li\x3e').appendTo(a).find("input").focus().on("blur",
function(){a.doTimeout("stopEditing",250,m)}).on("focus",function(){a.doTimeout("stopEditing")}).on("keyup",function(){var a=this;0<a.value.length?u.doTimeout("fetch",150,function(){a.value!=f&&(f=a.value,q.remote("/units/",{method:"GET",cache:"default",data:{q:f,type:e.types,include:"related_units"}}).then(function(a){v(a);a.units&&a.units.length?(u.empty().append(a.units.filter(function(a){return null==d[a.id]}).map(p)).show(),u.find("li").first().addClass("selected"),k()):u.hide()}))}):u.hide().doTimeout("fetch")}).on("keydown",
function(a){var b=a.keyCode?a.keyCode:a.which;if(40==b)return a.preventDefault(),u.find("li.selected").removeClass("selected").next("li").addClass("selected").length||u.find("li").eq(0).addClass("selected"),c(u.find("li.selected")),!1;if(38==b)return a.preventDefault(),u.find("li.selected").removeClass("selected").prev("li").addClass("selected").length||u.find("li").last().addClass("selected"),c(u.find("li.selected")),!1;if(13==b)return l(u.find("li.selected")),!1;if(27==b)return m(),!1});u.on("click",
"li",function(){l(b(this))})}function c(a){if(a.length){var b=a.closest("ul"),d=b.offset().top,e=d+b.outerHeight(),p=a.offset().top;a=p+a.outerHeight();p<d?b.scrollTop(b.scrollTop()+(p-d)):a>e&&b.scrollTop(b.scrollTop()+(a-e));return!0}}e.types&&e.types.length||(e.types=["subject","author"]);var h=!1,d=e.tags?e.tags.reduce(function(a,b){a[b.id]=b;return a},{}):{};a.on("click",function(d){console.log("got click",h);b(d.target).is("button,*[role\x3dbutton]")||(h?(console.log("got click for re-focus",
h),a.doTimeout("stopEditing"),a.find("input").focus()):k())}).on("click","li.tag .delete",function(){var a=b(this).closest("li");if(a&&a.length){var d=e.unit.parent_units.indexOf(a.data("id"));-1<d&&e.unit.parent_units.splice(d,1);a.remove()}return!1}).append(function(a){return a.unit.parent_units&&a.unit.parent_units.length?a.unit.parent_units.map(function(a){return d[a]}).filter(function(b){return null!=b&&-1!=a.types.indexOf(b.type)}).map(p):[]}(e))}function G(a,e){function p(){m.hasClass("editing")||
m.addClass("editing").find(".preview img").cropper({viewMode:3,aspectRatio:1,autoCropArea:1,scalable:!1,zoomable:!1,autoCrop:!1,ready:function(){var a=this.cropper.getContainerData();a=Math.min(a.width,a.height);this.cropper.crop();this.cropper.setCropBoxData({top:0,left:0,width:a,height:a})}})}function k(){m.hasClass("editing")&&(img=m.find(".preview img")[0],img.cropper&&(img.cropper.destroy(),delete img.cropper),b(img).data("cropper",null),m.removeClass("editing"))}function c(){var a=m.find(".preview img")[0],
b=a.cropper.getCroppedCanvas({imageSmoothingQuality:"high"});a.cropper.destroy();a.src=b.toDataURL("image/jpeg",1);b.toBlob(function(a){d.file=a;d.action="upload";d.filename=e.id+".jpg"},"image/jpeg",1);k()}function h(a){if(!a||!a.type)return!1;d.filename=e.id;if("image/jpeg"==a.type)d.filename+=".jpg";else if("image/png"==a.type)d.filename+=".png";else if(a.type.startsWith("image/svg"))d.filename+=".svg";else return!1;d.file=a;d.action="upload";console.log(d);if(a.type.startsWith("image/")){var b=
new FileReader;b.onload=function(a){m.addClass("with-preview").find(".preview img").attr("src",a.target.result)};b.readAsDataURL(a)}}var d={},m=b('\x3cdiv class\x3d"asset"\x3e\x3cbutton class\x3d"ss-delete"\x3e\x3c/button\x3e\x3ch4\x3e\x3c/h4\x3e\x3clabel\x3e\x3cspan\x3e\x3cstrong\x3eChoose a file\x3c/strong\x3e or drag one here.\x3c/span\x3e\n\t\t    \t\t\x3cinput type\x3d"file"\x3e\x3c/label\x3e\x3cdiv class\x3d"preview"\x3e\x3cimg \x3e\x3c/div\x3e\n\t\t    \t\t\x3cdiv class\x3d"controls"\x3e\n\t\t    \t\t\x3cbutton class\x3d"ss-write" data-action\x3d"cancel-edit-asset" \x3eCancel\x3c/button\x3e\n\t\t    \t\t\x3cbutton class\x3d"ss-write" data-action\x3d"edit-asset" \x3eEdit\x3c/button\x3e\n\t\t    \t\t\x3cbutton class\x3d"ss-crop" data-action\x3d"crop-asset" \x3eCrop\x3c/button\x3e\x3c/div\x3e\x3c/div\x3e');
m.data("asset",{commit:function(){var e=b.Deferred();a.id||e.reject({message:"No unit id"});"delete"==d.action?modules.vcom.api.remote("/units/"+a.id+"/assets/"+d.asset.name,{method:"DELETE"}).then(function(a){e.resolve({action:"delete"})}).fail(function(a){e.reject(a)}):"upload"==d.action&&d.file&&d.filename?modules.vcom.api.remote("/units/"+a.id+"/assets",{method:"POST",type:"json",data:{asset:{name:d.filename,content_type:d.file.type}}}).then(function(b){fetch(b.upload_url,{method:"PUT",headers:{"Content-Type":d.file.type,
"Content-Length":d.file.size},body:d.file}).then(function(b){e.resolve({action:"upload",url:u+a.id+"/"+d.filename})})["catch"](function(a){e.reject(a)})}):e.resolve({action:"none"});return e}}).on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault();a.stopPropagation()}).on("dragover dragenter",function(){m.addClass("is-dragover")}).on("dragleave dragend drop",function(){m.removeClass("is-dragover")}).on("drop",function(a){(a=a.originalEvent.dataTransfer.files)&&
a.length&&h(a[0])});m.find("button.ss-delete").on("click",function(){m.removeClass("with-preview").find(".preview img").attr("src",null);d.asset&&(d.action="delete");delete d.file});m.find("h4").text(e.name);m.find("input").on("change",function(a){h(a.target.files[0])});a.assets&&(a.assets.forEach(function(a){var b=a.name.lastIndexOf(".");-1<b&&a.name.substring(0,b)==e.id&&(d.asset=a)}),d.asset&&(m.addClass("with-preview").find(".preview img").attr("src",u+a.id+"/"+d.asset.name),m.on("click",'*[data-action\x3d"cancel-edit-asset"]',
k),m.on("click",'*[data-action\x3d"edit-asset"]',p),m.on("click",'button[data-action\x3d"crop-asset"]',c)));return m}function g(a){switch(a.type){case "work":return"Work";case "author":return"Author";case "publisher":return"Publisher";case "collection":return"Collection";case "subject":return"Subject";case "list":return"List";default:return"Unit"}}function I(a){var e=b('\x3cdiv class\x3d"group styles"\x3e\x3cdiv class\x3d"field text"\x3e\x3clabel\x3eStyle\x3c/label\x3e\x3cselect\x3e\n\t\t\t\t\x3coption value\x3d""\x3eDefault\x3c/option\x3e\n\t\t\t\t\x3coption value\x3d"feature"\x3eFeature: Standard\x3c/option\x3e\n\t\t\t\t\x3coption value\x3d"items-right"\x3eFeature: Items Right\x3c/option\x3e\n\t\t\t\t\x3coption value\x3d"items-hidden"\x3eFeature: No Items\x3c/option\x3e\n\t\t\t\t\x3coption value\x3d"tribute"\x3eTribute\x3c/option\x3e\n\t\t\t\t\x3coption value\x3d"preap"\x3ePre-AP\x3c/option\x3e\n\t\t\t\t\x3c/select\x3e\x3c/div\x3e\x3c/div\x3e'),
p=a.style||{},k=b("\x3cdiv\x3e\x3c/div\x3e").append(x(n({field:"color",label:"Text Color"},p),n({field:"background_color",label:"Background Color"},p))),m=e.find("select");a.style&&a.style.id&&m.val(a.style.id);m.on("change",function(){this.value.length?(p.id=this.value,a.style=p,k.show()):(a.style=null,k.hide())}).trigger("change");return x(e,k)}function n(a,e){a.resetValue=e[a.field];var k=b('\x3cdiv class\x3d"field color"\x3e\x3clabel\x3e\x3c/label\x3e\x3cspan class\x3d"swatch"\x3e\x3c/span\x3e\x3c/div\x3e').find("label").html(a.label).end(),
m=Pickr.create({el:k.find(".swatch")[0],theme:"nano","default":null,components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,hsla:!0,hsva:!0,cmyk:!0,input:!0,clear:!0,save:!0}}});m.on("init",function(){e[a.field]&&e[a.field].length&&"#"==e[a.field].charAt(0)&&(a.field,m.setColor(e[a.field]))});m.on("save",function(b){b&&(e[a.field]=b.toHEXA().toString(),console.log(e))});return k}function x(){return b('\x3cdiv class\x3d"group"\x3e\x3c/div\x3e').append(Array.prototype.slice.call(arguments))}
function C(a,e){a.resetValue=e[a.field];var k=b('\x3cdiv class\x3d"field text"\x3e\x3clabel\x3e\x3c/label\x3e\x3cselect\x3e\x3c/select\x3e\x3c/div\x3e').attr("data-field-name",a.field).find("label").html(a.label).end().find("select").attr(H(a,["required"])).append((a.options||[]).map(function(e){var k=b("\x3coption\x3e\x3c/option\x3e").text(e.text||e.value).attr("value",e.value);e.value==a.resetValue&&k.attr("selected",!0);return k})).on("blur",function(){var b=this.value;e[a.field]="int"==a.type?
y(b):b}).on("reset",function(){b(this).val(a.resetValue)}).end();if("int"==a.type)k.find("input").on("keypress",B);return k}function c(a,e){a.resetValue=e[a.field];return b('\x3cdiv class\x3d"field text"\x3e\x3clabel\x3e\x3c/label\x3e\x3cinput type\x3d"checkbox"\x3e\x3c/div\x3e').attr("data-field-name",a.field).find("label").html(a.label).end().find("input").prop("checked",null!=a.resetValue&&a.resetValue||1==a["default"]?"checked":"").on("blur",function(){e[a.field]=this.checked}).on("reset",function(){b(this).val(a.resetValue)}).end()}
function f(a,e){try{a.resetValue=e[a.field]?(new Date(e[a.field])).format("mm/dd/yyyy"):null}catch(A){}var k=b('\x3cdiv class\x3d"field date"\x3e\x3clabel\x3e\x3c/label\x3e\x3cinput type\x3d"text" maxlength\x3d"10" length\x3d"10" data-date-format\x3d"mm/dd/yyyy"\x3e\x3c/div\x3e').attr("data-field-name",a.field).find("label").html(a.label).end().find("input").attr(H(a,["placeholder","required"])).prop("value",a.resetValue||"").on("blur",function(){var b=this.value.trim();try{e[a.field]=(new Date(b)).toJSON()}catch(J){}}).on("reset",
function(){b(this).prop("value",a.resetValue||"")}).end();k.find("input").datepicker();return k}function r(a,e){console.log(a);console.log(e);a.resetValue=e[a.field];var k=b('\x3cdiv class\x3d"field text"\x3e\x3clabel\x3e\x3c/label\x3e\x3cinput type\x3d"text"\x3e\x3c/div\x3e').attr("data-field-name",a.field).find("label").html(a.label).end().find("input").attr(H(a,["placeholder","required","pattern","length","maxlength"])).prop("value",e[a.field]||"").on("blur",function(){var b=this.value.trim();
e[a.field]="int"==a.type?y(b):b}).on("reset",function(){b(this).prop("value",a.resetValue)}).end();if("int"==a.type)k.find("input").on("keypress",B);return k}function E(a,e){a.resetValue=e[a.field];return b('\x3cdiv class\x3d"field textarea"\x3e\x3clabel\x3e\x3c/label\x3e\x3ctextarea\x3e\x3c/textarea\x3e\x3c/div\x3e').attr("data-field-name",a.field).find("label").html(a.label).end().find("textarea").attr(H(a,"placeholder required pattern rows cols maxlength".split(" "))).val(e[a.field]||"").on("blur",
function(){e[a.field]=this.value.trim();b(this).css("height","")}).on("reset",function(){this.value=a.resetValue}).on("focus",function(){b(this).height(this.scrollHeight)}).end()}function y(a){if(null==a||!a.length)return null;a=parseInt(a);return isNaN(a)?null:a}function B(a){a=a.which?a.which:event.keyCode;return 31<a&&(48>a||57<a)?!1:!0}function H(a,b){return b.reduce(function(b,e){b[e]=a[e];return b},{})}var q=modules.vcom.api;this.editUnit=function(a){return modules.vcom.api.remote("/units/"+
a).then(v).then(D)};this.newUnit=z;var b=jQuery,k=["image/jpeg","image/png","image/svg"],m={work:{assets:[{id:"cover",name:"Cover Image",types:k}]},author:{assets:[{id:"author",name:"Author Image",types:k}]},publisher:{assets:[{id:"bg",name:"Background Image",types:k},{id:"feature",name:"Feature Image",types:k},{id:"logo",name:"Logo Image",types:k}]},collection:{assets:[{id:"bg",name:"Background Image",types:k},{id:"feature",name:"Feature Image",types:k},{id:"logo",name:"Logo Image",types:k},{id:"cover",
name:"Cover Image",types:k}]},unit:{assets:[{id:"bg",name:"Background Image",types:k},{id:"feature",name:"Feature Image",types:k},{id:"cover",name:"Cover Image",types:k}]}};(k=Module.getResource("/css/unit_editor.css"))&&!b('head link[src\x3d"'+k+'"]').length&&Module.loadCss(k);var u="https://com-vocab-unitassets.s3.amazonaws.com/units/"});
Module.define("vcom/units/explorer",["vcom/api","jquery","htmlformat","jquery.waypoints","dotimeout"],function(){function v(c,f){return c==f?0:null==c?-1:null==f?1:c<f?-1:c==f?0:1}function z(){n("li[data-list-id]:not(.open)").first().waypoint({handler:function(){G.call(this.element)},offset:"bottom-in-view"})}function D(c,f){c||(c=C);C=c;n(".word-explorer .wordlist").each(function(){F(n(this),c,f)})}function F(c,f,g){f||(f=C);var r=c.children("li").sort(x[f]),y=[];g&&r.each(function(){y.push(n(this).position())});
c.append(r.sort(x[f]).detach());g&&(c.addClass("static"),r.each(function(c){var f=n(this).position();f.left-=y[c].left;f.top-=y[c].top;n(this).css("transform","translate("+-f.left+"px,"+-f.top+"px)")}),c.removeClass("static").addClass("animated"),setTimeout(function(){r.css("transform","")},1),setTimeout(function(){c.removeClass("animated")},1E3))}function G(){var c=n(this);if(!c.is(".open"))return c.addClass("open"),modules.vcom.api.remote("/lists/"+c.data("list-id")).then(function(f){f=g(f.wordlist).appendTo(c.find(".wrapper"));
var r=f.outerHeight();f.css("max-height",0);f.doTimeout("max-height",1,"css","max-height",r);f.doTimeout("remove-max-height",1E3,"css","max-height","");"list"!=C&&F(f);setTimeout(z,500)})}function g(c){var f=n('\x3col class\x3d"wordlist"\x3e\x3c/ol\x3e');f.append(c.words.map(function(c,f){c.index=f;f=n("\x3cli\x3e\x3c/li\x3e").data(c).toggleClass("learnable",c.learnable).append(n('\x3ca class\x3d"word"\x3e\x3c/a\x3e').attr("href","/dictionary/"+escape(c.word)).text(c.word).append('\x3cspan class\x3d"comma"\x3e, \x3c/span\x3e')).append(n('\x3cdiv class\x3d"def"\x3e\x3c/div\x3e').text(c.sense.definition).addClass(c.sense.part_of_speech)).append(I(c.example));
c.description&&n('\x3cdiv class\x3d"description"\x3e\x3c/div\x3e').html(modules.htmlformat.format(c.description)).appendTo(f);return f}));return f}function I(c){var f=n('\x3cdiv class\x3d"example"/\x3e');if(null!=c)if(c.offsets.length){var g=[],v=c.text;c=c.offsets;for(var y=0,B=0;B<c.length;B+=2)g.push(v.substring(y,c[B])),g.push("\x3cstrong\x3e"),g.push(v.substring(c[B],c[B+1])),g.push("\x3c/strong\x3e"),y=c[B+1];g.push(v.substring(y));f.html(modules.htmlformat.format(g.join("")))}else f.html(modules.htmlformat.format(c.text));
return f}var n=jQuery;n(function(){n(".word-explorer li[data-list-id]").first().each(G);n(".word-explorer \x3e .actions a.view").on("click",function(){n(this).addClass("selected").siblings("a.view").removeClass("selected");var c=n(this).data("view");n(".word-explorer").attr("data-view",c);"words"==c&&n(".word-explorer li[data-list-id]").each(G)});n(".word-explorer \x3e .actions select").on("change",function(){D(this.value,!0)})});var x={list:function(c,f){c=n(c).data();f=n(f).data();return c.index-
f.index},az:function(c,f){c=n(c).data();f=n(f).data();return v(c.word,f.word)},za:function(c,f){c=n(c).data();f=n(f).data();return v(f.word,c.word)},easy:function(c,f){c=n(c).data();f=n(f).data();return v(f.frequency,c.frequency)},hard:function(c,f){c=n(c).data();f=n(f).data();return v(c.frequency,f.frequency)}},C="list"});
Module.define("vcom/units/searcher",["jquery","dotimeout","vcom/api"],function(){var v=jQuery;this.Searcher=function(z){function D(){var c=E.val().trim();if("lists"==r.data("mode")){var g=r.find("ul.results.lists").addClass("loading");2>c.length?n().then(function(c){g.empty().removeClass("loading").append(c.filter(z.listFilter).map(F))}):f.remote("/lists",{data:{q:c+"*",include:"profiles",limit:10}}).then(function(c){g.empty().removeClass("loading").append(c.wordlists.filter(z.listFilter).map(F))})}else g=
r.find("ul.results.units").addClass("loading"),2>c.length?I().then(function(c){g.empty().removeClass("loading").append(c.filter(z.unitFilter).map(G))}):f.remote("/units",{data:{q:c,limit:10,type:z.types}}).then(function(c){g.empty().removeClass("loading").append(c.units.filter(z.unitFilter).map(G))})}function F(c){return v('\x3cli class\x3d"tag"\x3e\x3cspan class\x3d"item-type"\x3eList\x3c/span\x3e\x3cspan class\x3d"title"\x3e\x3c/span\x3e\x3c/li\x3e').data(c).find(".title").text(c.name+" ("+c.id+
")").end()}function G(c){return v('\x3cli class\x3d"tag"\x3e\x3cspan class\x3d"item-type"\x3e\x3c/span\x3e\x3cspan class\x3d"title"\x3e\x3c/span\x3e\x3c/li\x3e').data(c).addClass(c.type).find(".item-type").text(g(c)).end().find(".title").text(c.title).end()}function g(c){switch(c.type){case "author":return"Author";case "work":return"Work";case "subject":return"Subject";case "publisher":return"Publisher";case "collection":return"Collection";default:return"Unit"}}function I(){if(null!=C)return C;var c=
v.Deferred(),g=VCOM.recentUnits().filter(function(c){return c!=x.id});g.length?f.remote("/units/",{data:{ids:g}}).then(function(f){var q=f.units.reduce(function(b,c){b[c.id]=c;return b},{});f=g.reduce(function(b,c){q[c]&&b.push(q[c]);return b},[]);c.resolve(f)}):c.resolve([]);return C=c}function n(){if(null!=c)return c;var g=v.Deferred(),n=VCOM.recentLists();n.length?f.remote("/lists/",{data:{ids:n,include:"profiles"}}).then(function(c){var f=c.wordlists.reduce(function(b,c){b[c.id]=c;return b},{});
c=n.reduce(function(b,c){f[c]&&b.push(f[c]);return b},[]);g.resolve(c)}):g.resolve([]);return c=g}var x=z.unit;z.unitFilter=z.unitFilter||function(c){return c.id==x.id||x.parent_units&&x.parent_units.find(function(f){return f==c.id})||x.items&&x.items.find(function(f){return f.id==c.id})?!1:!0};z.listFilter=z.listFilter||function(c){return x.items&&x.items.find(function(f){return f.id==c.id})?!1:!0};var C,c,f=modules.vcom.api,r=v('\x3cdiv class\x3d"list-unit-searcher"\x3e\n\t\t\x3cdiv class\x3d"input"\x3e\x3cdiv class\x3d"unit-or-list"\x3e\x3clabel\x3e\x3cinput type\x3dradio value\x3d"units"\x3e\x3cspan\x3eUnits\x3c/span\x3e\x3c/label\x3e\x3clabel\x3e\x3cinput type\x3d"radio" value\x3d"lists"\x3e\x3cspan\x3eLists\x3c/span\x3e\x3c/label\x3e\x3c/div\x3e\n\t\t\x3cinput type\x3d"text" placeholder\x3d"Search"\x3e\x3c/div\x3e\n\t\t\x3cul class\x3d"results lists"\x3e\x3c/ul\x3e\n\t\t\x3cul class\x3d"results units"\x3e\x3c/ul\x3e\n\t\t\x3c/div\x3e');
r.data("refilter",function(){r.find("ul.results.lists li").show().filter(function(){var c=v(this);return!z.listFilter(c.data())}).hide();r.find("ul.results.units li").show().filter(function(){var c=v(this);return!z.unitFilter(c.data())}).hide()});r.find("input[type\x3dradio][value\x3dunits]").prop("checked",!0);r.find("input[type\x3dradio]").change(function(){if(this.checked){r.find("input[type\x3dradio]").not(this).prop("checked",!1);var c=this.value;r.data("mode")!=c&&(r.attr("data-mode",c).data("mode",
c),D());E.focus()}});r.on("click",".results.lists li",function(){r.trigger({type:"select",list:v(this).data()});E.focus()}).on("click",".results.units li",function(){r.trigger({type:"select",unit:v(this).data()});E.focus()});var E=r.find("input[type\x3dtext]").on("keydown",function(){E.doTimeout("search",200,function(){D()})}).on("focus",function(){r.addClass("focused").doTimeout("focus")}).on("blur",function(){r.doTimeout("focus",250,"removeClass","focused")});D();return r}});
Module.define("vcom/units/viewer",["vcom/api","jquery","jquery.waypoints","date"],function(){function v(b){var c=q('\x3cli\x3e\x3cdiv class\x3d"info"\x3e\x3ca\x3e\x3cspan class\x3d"type"\x3e\x3c/span\x3e\x3cspan class\x3d"title"\x3e\x3c/span\x3e\x3cspan class\x3d"subtitle"\x3e\x3c/span\x3e\x3c/a\x3e\x3cspan class\x3d"author"\x3e\x3c/span\x3e\x3cdiv class\x3d"description"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/li\x3e');a:{var m=B[b.type]||B.collection;if("work"==b.type&&b.parent_units)for(var f=b.parent_units.length-
1;0<=f;f--){var a=H[b.parent_units[f]];if(a){m=a;break a}}}m.tag&&c.addClass(m.tag);c.find(".type").text(m.title);c.find(".title").text(b.full_title);c.find(".author").text(b.author?"By "+b.author:"");c.find(".subtitle").text(b.subtitle||"");c.find(".description").text(q("\x3cdiv\x3e\x3c/div\x3e").text((b.short_description||"").stripHTML().truncateNicely(100)).text());c.addClass("type_"+b.type);a:{if(b.assets)for(f=B[b.type]||B.collection,m=0;m<b.assets.length;m++)for(a=0;a<f.icon.length;a++)if(f.icon[a].test(b.assets[m].name)){f=
Math.floor((new Date(b.modified_at)).getTime()/1E3).toString(16);m=["https://cdn.vocab.com/units/"+b.id+"/"+b.assets[m].name+"?width\x3d170\x26v\x3d"+f,b.assets[m].name];break a}m=void 0}m&&(f=q('\x3ca class\x3d"icon"\x3e\x3cimg \x3e\x3c/a\x3e').attr("alt",b.title).find("img").attr("src",m[0]).end().prependTo(c),/^cover/.test(m[1])&&f.addClass("cover-icon"));b.style&&(b.style.id&&c.addClass("style-"+b.style.id),b.style.background_color&&c.find(".icon img").css("background-color",b.style.background_color));
c.append('\x3cdiv class\x3d"actions"\x3e\x3ca class\x3d"button learn"\x3eLearn\x3c/a\x3e\x3ca class\x3d"button assign"\x3eAssign\x3c/a\x3e\x3c/div\x3e');c.find("a").attr("href",b.html_url);c.find("a.assign").attr("href",b.html_url+"/assign");return c}function z(b,c){return VCOM.authCache.get().then(function(f){var k=b.reduce(function(a,b){a[b]=[];return a},{}),a=!0;f.classes&&f.classes.memberOf&&f.classes.memberOf.forEach(function(b){b.assignments&&b.assignments.forEach(function(e){null!=c&&e.type!=
c||!k[e.listid]||(e=q.extend({cl:b},e),e.dueDate=new Date(e.dueDate),k[e.listid].push(e),a=!1)})});k.empty=a;return k})}function D(b,c){var f={p:{},s:{}};b.forEach(function(b){for(t in f){var a=F(c,t,b);f[t][b]=a;if(a.activities.length||a.assignments.length)f[t].hasDetails=!0}});return q.extend({byType:f,lists:b},c)}function F(b,c,f){var k={};k.assignments=(b.assignments[f]||[]).filter(function(a){return a.type==c});k.activities=b.activities.filter(function(a){return a.activity_type==c&&a.list_id==
f});k.activities.sort(function(a,b){return a.progress||0<b.progress?-1:a.progress||0>b.progress?1:a.played_at<b.played_at?-1:a.played_at>b.played_at?1:0});b.mastery&&b.mastery.length&&(b=b.mastery.find(function(a){return a.list_id==f}))&&(k.mastery=b);return k}function G(b){var c=[];b.find("li[data-list-id]").each(function(){c.push(q(this).data("list-id"))});return c}function g(b,c,f){function m(a){return q('\x3cli\x3e\x3ca \x3e\x3cspan class\x3d"when"\x3e\x3c/span\x3e\x3ccanvas class\x3d"progress" width\x3d"80" height\x3d"80"\x3e\x3c/canvas\x3e\x3c/a\x3e\x3c/li\x3e').find("a").attr("href",
"/lists/"+a.list_id+"/"+c.prefix+"?aid\x3d"+a.id).end().find(".when").text(c.name+" "+(1==a.progress?"completed ":"played ")+n(new Date(a.played_at))).end().find("canvas").attr("data-progress",Math.floor(100*a.progress)).end()}"string"===typeof c&&(c=y[c]);c||(c=y.p);b.attr("data-mode",c.code);if(f.lists.length){var a=b.find("li[data-list-id]");a.find(".activity-history, .assignments, .actions").empty();a.removeClass("activity-complete on-deck");if("j"==c.code)a.addClass("on-deck").removeClass("started").each(function(){var a=
q(this).data("list-id");q(this).find(".actions").append('\x3ca role\x3d"button" href\x3d"/lists/'+a+'/jam" class\x3d"button outline" \x3eStart\x3cspan class\x3d"hide-mobile"\x3e '+c.shortName+"\x3c/span\x3e\x3c/a\x3e")}),b.removeClass("with-details");else{var e=f.byType[c.code]||{};b.toggleClass("with-details",!!e.hasDetails);a.each(function(){var a=q(this),b=a.data("list-id"),f=e[b];a.find(".actions");var h=a.find(".activity-history"),d=f&&f.activities||[],k=d[0];if(d.length){a.addClass("started");
h.append("\x3col\x3e\x3c/ol\x3e");var g=h.find("ol"),u=d.filter(function(a){return a!=k});u.length&&(u.sort(function(a,b){return a.played_at<b.played_at?1:a.played_at>b.played_at?-1:0}),q('\x3ca class\x3d"toggle" role\x3d"button"\x3ePlayed \x3cspan class\x3d"count"\x3e\x3c/span\x3e other times\x3c/a\x3e').find(".count").text(u.length.commaFormat()).end().appendTo(h).on("click",function(){u.splice(0,5).forEach(function(a){a=m(a).appendTo(g);VCOM.parse(a)});u.length?q(this).find(".count").text(u.length.commaFormat()):
q(this).remove()}));m(k).appendTo(g);1==k.progress?(a.addClass("activity-complete"),"p"==c.code&&(!f.mastery||1>f.mastery.progress)&&a.find(".actions").prepend('\x3cspan role\x3d"button" data-action\x3d"complete-mastery" class\x3d"button outline" \x3eFinish Mastery\x3c/span\x3e')):q('\x3ca class\x3d"button outline" \x3eResume\x3cspan class\x3d"hide-mobile"\x3e '+c.shortName+"\x3c/span\x3e\x3c/a\x3e").attr("href","/lists/"+b+"/"+c.prefix+(null==k?"":"?aid\x3d"+k.id)).appendTo(a.find(".actions"))}else a.removeClass("started"),
q('\x3ca class\x3d"button outline" \x3eStart\x3cspan class\x3d"hide-mobile"\x3e '+c.shortName+"\x3c/span\x3e\x3c/a\x3e").attr("href","/lists/"+b+"/"+c.prefix).appendTo(a.find(".actions"));f&&f.assignments.length&&a.find(".assignments").empty().append("\x3col\x3e\x3c/ol\x3e").find("ol").append(f.assignments.map(function(a){return q("\x3cli\x3e\x3c/li\x3e").toggleClass("overdue",!k||1>k.progress?a.dueDate<new Date:a.dueDate<new Date(k.last_played)).append(q('\x3cspan class\x3d"duedate"\x3eDue '+n(a.dueDate)+
"\x3c/span\x3e")).append(" for ").append(q("\x3ca\x3e\x3c/a\x3e").text(a.cl.name).attr("href","/classes/"+a.cl.id))}))});if("p"==c.code)a.on("click",'*[data-action\x3d"complete-mastery"]',function(){var a=q(this).closest("*[data-list-id]").data("list-id");document.location.href="/play/"+a;return!1})}VCOM.parse(a);a.filter(":not(.activity-complete)").first().addClass("on-deck")}}function I(b,c){E||(E=VCOM.authCache.get().then(function(f){return f.validUser?q.when(modules.vcom.api.remote("/progress/activities",
{data:{list_id:b,include:c?"mastery":null,limit:1E3}}),z(b)):q.when({activities:[]},{})}));return E.then(function(b,c){b.assignments=c;return b})}function n(b){"number"===typeof b&&(b=/(\d\d\d\d)(\d\d)(\d\d)/.exec(b),b=new Date(b[1],b[2]-1,b[3]));b="function"===typeof b.getTime?b:new Date(b);var k=(new Date).getTime();return(x(b,c)?"yesterday":x(b,f)?"tomorrow":x(b,C)?"today":b.getTime()>k&&b.getTime()-6048E5<k?b.format("dddd"):b.format(b.getFullYear()==r?"mmmm dS":"mmmm dS, yyyy"))+" at "+b.format("h:MM tt")}
function x(b,c){return b.getFullYear()==c.getFullYear()&&b.getMonth()==c.getMonth()&&b.getDate()==c.getDate()}var C=new Date,c=new Date,f=new Date,r=C.getFullYear();c.setDate(c.getDate()-1);f.setDate(f.getDate()+1);var E=null,y={p:{code:"p",name:"Practice",shortName:"Practice",prefix:"practice"},s:{code:"s",name:"Spelling Bee",shortName:"Bee",prefix:"bee"},j:{code:"j",name:"Vocabulary Jam",shortName:"a Jam",prefix:"jam"},q:{code:"q",name:"Quiz",shortName:"Quiz"}},B={work:{icon:[/^cover/],title:"Work"},
author:{icon:[/^author/],title:"Author"},collection:{icon:[/^feature/,/^cover/],title:"Collection"},unit:{icon:[/^feature/,/^cover/],title:"Collection"},publisher:{icon:[/^feature/],title:"Publisher"},subject:{icon:[/^feature/],title:"Subject"}},H={kecpw3dy:{title:"Test Prep",tag:"TST"},lnin7xdp:{title:"Morphology \x26 Roots",tag:"ROOTS"},gfpldfb3:{title:"Literature",tag:"LIT",url:"/lists/literature/"},igonyd6p:{title:"Non-Fiction",tag:"NON",url:"/lists/non-fiction/"},"5gi4cws6":{title:"Textbooks \x26 Curricula",
tag:"TXT",url:"/lists/textbooks-and-curricula/"},aoqd4lh6:{title:"Historical Documents",tag:"HIST",url:"/lists/historical-documents/"},z2pwznqw:{title:"Speeches",tag:"SPH",url:"/lists/speeches/"},alhahx3a:{title:"Just for Fun",tag:"FUN",url:"/lists/just-for-fun/"},hehvvpjm:{title:"News",tag:"NWS",url:"/lists/news/"}},q=jQuery;q.fn.unitList=function(){function b(){var a={limit:g.limit,skip:g.skip};g.taggedWithUnitid&&(a.tagged_with_unitid=g.taggedWithUnitid);g.query&&(a.q=g.query);g.sortBy&&(a.sort_by=
g.sortBy);g.sortDirection&&(a.sort_direction=g.sortDirection);return modules.vcom.api.remote("/units/",{data:a,type:"raw"}).then(function(a){var b=a.json;0==g.skip&&f.empty();f.removeClass("loading").append(b.units.map(v));f.trigger("dataLoaded",a);var e=parseInt(a.headers["x-total-count"]||-1);a=/rel="next"/.test(a.headers.link||"");e=-1==e?g.limit:e-(g.limit+g.skip);a?(g.autoload||q('\x3cbutton class\x3d"loadmore "\x3eShow \x3cspan class\x3d"count"\x3e'+e.commaFormat()+"\x3c/span\x3e more Collections\x3c/button\x3e").appendTo(f),
g.autoload&&0==g.skip&&c(),f.addClass("hasmore"),g.skip+=g.limit,12>g.limit&&(g.limit=12)):f.removeClass("hasmore");0==g.skip&&0==b.units.length&&q('\x3cdiv class\x3d"noresults"\x3eSorry, we didn\'t find any collections that match your search.\x3c/div\x3e').appendTo(f)})}function c(){var a=f.waypoint({offset:"bottom-in-view",handler:function(c){"down"==c&&f.hasClass("hasmore")&&(f.removeClass("hasmore").addClass("loading"),b().then(function(){a.context.refresh()}))}})[0]}var f=this,g=q.extend({limit:100,
skip:0},f.data());f.on("click","button.loadmore",function(){this.remove();f.addClass("loading");b()});b();return this};q.fn.activityPicker=function(){function b(a,b){if(b=a.byType[b])for(var e=0;e<a.lists.length;e++){var f=a.lists[e],g=b[f].activities[0];if(!g||0==g.progress)return{action:"Start",id:f,name:c(f),progress:0,index:e};if(g&&1>g.progress)return{action:"Resume",id:f,name:c(f),progress:g.progress,index:e}}else return f=a.lists[0],{action:"Start",id:f,name:c(f),progress:0,index:0}}function c(a){return f.find('li[data-list-id\x3d"'+
a+'"] .title').first().text()}var f=this,n=G(f),a=I(n,!f.data("listId")).then(D.bind(this,n));f.find(".activity-list li").on("click",function(){var b=q(this);b.is(".selected")||(b.siblings(".selected").removeClass("selected"),b.addClass("selected"),a.then(function(a){g(f,b.data("activity-type"),a)}))});a.then(function(a){g(f,"p",a);f.find(".activity-list li").each(function(){var c=q(this),e=c.data("activity-type"),g=c.find(".actions"),h=b(a,e);if("j"==e)g.append('\x3ca role\x3d"button" href\x3d"/lists/'+
a.lists[0]+'/jam" class\x3d"button outline"\x3eStart\x3cspan class\x3d"hide-mobile"\x3e a Jam\x3c/span\x3e\x3c/a\x3e'),g.append('\x3ca role\x3d"button" href\x3d"/jam" class\x3d"button outline"\x3eJoin \x3cspan class\x3d"hide-mobile"\x3e a Jam\x3c/span\x3e\x3c/a\x3e'),c.find(".upnext").append("\x3clabel\x3eStart:\x3c/label\x3e").append(q("\x3cspan\x3e\x3c/span\x3e").text(h.name));else if(h=b(a,e),null!=h){var d=y[e];0<h.progress?c.find(".upnext").append("\x3clabel\x3ePlaying:\x3c/label\x3e").append(q('\x3cspan class\x3d"name"\x3e\x3c/span\x3e').text(h.name)).append(q('\x3cspan class\x3d"progress"\x3e\x3c/span\x3e').text(Math.floor(100*
h.progress)+"%")):c.find(".upnext").append("\x3clabel\x3eNext:\x3c/label\x3e").append(q('\x3cspan class\x3d"name"\x3e\x3c/span\x3e').text(h.name));g.append('\x3ca role\x3d"button" href\x3d"/lists/'+h.id+"/"+d.prefix+'" class\x3d"button outline"\x3e'+h.action+' \x3cspan class\x3d"hide-mobile"\x3e '+d.shortName+"\x3c/span\x3e\x3c/a\x3e")}else c.find(".upnext").append("\x3clabel\x3eDetails\x3c/label\x3e");f.data("listId")&&(c.find(".upnext label").text("Details"),a.byType[e]&&a.byType[e].hasDetails||
c.addClass("empty"))})})}});